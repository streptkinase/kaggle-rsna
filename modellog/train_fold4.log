
----- 2019-10-23 07:20:47 -----
/mnt/disks/mount_point/rsna_root/kaggle-rsna-intracranial-hemorrhage/src/cnn/main.py train ./conf/model001.py --fold 4 --gpu 0
logpath: ./model/model001/train_fold4.log
mode: train
workdir: ./model/model001
fold: 4
batch size: 28
acc: 1
model: se_resnext50_32x4d
pretrained: imagenet
loss: BCEWithLogitsLoss
optim: Adam
dataset_policy: all
window_policy: 2
read dataset (532995 records)
applied dataset_policy all (532995 records)
use default(random) sampler
dataset_policy: all
window_policy: 2
read dataset (132419 records)
applied dataset_policy all (132419 records)
use default(random) sampler
train data: loaded 532995 records
valid data: loaded 132419 records
last_epoch: -1
apex True

----- epoch 0 -----
[train] 19035/19035 9968(s) eta:0(s) loss:0.101947 loss200:0.093701 lr:6.00e-05 auc:0.9685 micro:0.9739 macro:0.9631
0.087393 [0.140902 0.019147 0.108248 0.092726 0.045322 0.064506]
[valid] 4730/4730 1560(s) eta:0(s) loss:0.089763 loss200:0.090360 lr:0.00e+00 auc:0.9776 micro:0.9808 macro:0.9744
0.076961 [0.12262  0.016872 0.09801  0.084666 0.036273 0.057663]
saved model to ./model/model001/fold4_ep0.pt
[best] ep:0 loss:0.0898 score:0.0770

----- epoch 1 -----
[train] 19035/19035 10051(s) eta:0(s) loss:0.081413 loss200:0.081455 lr:4.00e-05 auc:0.9816 micro:0.9845 macro:0.9786
0.069782 [0.112288 0.015622 0.088784 0.07645  0.032666 0.05038 ]
[valid] 4730/4730 1587(s) eta:0(s) loss:0.086284 loss200:0.085617 lr:0.00e+00 auc:0.9800 micro:0.9828 macro:0.9772
0.073957 [0.120874 0.015108 0.097751 0.078445 0.033255 0.051393]
saved model to ./model/model001/fold4_ep1.pt
[best] ep:1 loss:0.0863 score:0.0740

----- epoch 2 -----
[train] 19035/19035 10085(s) eta:0(s) loss:0.072635 loss200:0.071820 lr:2.67e-05 auc:0.9862 micro:0.9882 macro:0.9841
0.062261 [0.099688 0.0137   0.080466 0.069293 0.028367 0.044624]
[valid] 4730/4730 1596(s) eta:0(s) loss:0.085016 loss200:0.084600 lr:0.00e+00 auc:0.9810 micro:0.9837 macro:0.9783
0.072852 [0.118921 0.015244 0.096557 0.078575 0.031708 0.050041]
saved model to ./model/model001/fold4_ep2.pt
[best] ep:2 loss:0.0850 score:0.0729

----- 2019-10-24 04:32:23 -----
/mnt/disks/mount_point/rsna_root/kaggle-rsna-intracranial-hemorrhage/src/cnn/main.py train ./conf/model001.py --fold 4 --gpu 0 --resume_from fold4_ep2.pt
logpath: ./model/model001/train_fold4.log

----- 2019-10-24 12:45:48 -----
/mnt/disks/mount_point/rsna_root/kaggle-rsna-intracranial-hemorrhage/src/cnn/main.py train ./conf/model001.py --fold 4 --gpu 0 --resume_from model/model001/fold4_ep2.pt
logpath: ./model/model001/train_fold4.log
mode: train
workdir: ./model/model001
fold: 4
batch size: 28
acc: 1
resume_from: model/model001/fold4_ep2.pt
model: se_resnext50_32x4d
pretrained: imagenet
loss: BCEWithLogitsLoss
optim: Adam
loading optim too
loaded model from model/model001/fold4_ep2.pt
dataset_policy: all
window_policy: 2
read dataset (532995 records)
applied dataset_policy all (532995 records)
use default(random) sampler
dataset_policy: all
window_policy: 2
read dataset (132419 records)
applied dataset_policy all (132419 records)
use default(random) sampler
train data: loaded 532995 records
valid data: loaded 132419 records
last_epoch: 2
apex True

----- 2019-10-26 05:12:47 -----
/mnt/disks/mount_point/rsna_root/kaggle-rsna-intracranial-hemorrhage/src/cnn/main.py train ./conf/model001.py --fold 4 --gpu 0 --resume_from model/model001/fold4_ep2.pt
logpath: ./model/model001/train_fold4.log
mode: train
workdir: ./model/model001
fold: 4
batch size: 28
acc: 1
resume_from: model/model001/fold4_ep2.pt
model: se_resnext50_32x4d
pretrained: imagenet
loss: BCEWithLogitsLoss
optim: Adam
loading optim too
loaded model from model/model001/fold4_ep2.pt
dataset_policy: all
window_policy: 2
read dataset (532995 records)
applied dataset_policy all (532995 records)
use default(random) sampler
dataset_policy: all
window_policy: 2
read dataset (132419 records)
applied dataset_policy all (132419 records)
use default(random) sampler
train data: loaded 532995 records
valid data: loaded 132419 records
last_epoch: 2
apex True

----- epoch 3 -----
[train] 19035/19035 10508(s) eta:0(s) loss:0.065409 loss200:0.059548 lr:1.78e-05 auc:0.9893 micro:0.9907 macro:0.9878
0.056069 [0.088929 0.01173  0.073352 0.063693 0.025613 0.040238]
[valid] 4730/4730 1830(s) eta:0(s) loss:0.087277 loss200:0.087479 lr:0.00e+00 auc:0.9806 micro:0.9831 macro:0.9782
0.074813 [0.122696 0.016422 0.099646 0.079732 0.031833 0.050665]
saved model to ./model/model001/fold4_ep3.pt
[best] ep:2 loss:0.0850 score:0.0729

----- epoch 4 -----
[train] 19035/19035 10436(s) eta:0(s) loss:0.060882 loss200:0.062905 lr:1.78e-05 auc:0.9909 micro:0.9920 macro:0.9897
0.052184 [0.082076 0.01049  0.068387 0.060367 0.024045 0.037848]
[valid] 4730/4730 1778(s) eta:0(s) loss:0.087873 loss200:0.088138 lr:0.00e+00 auc:0.9797 micro:0.9824 macro:0.9769
0.075297 [0.122775 0.015909 0.10211  0.079617 0.032587 0.051307]
saved model to ./model/model001/fold4_ep4.pt
[best] ep:2 loss:0.0850 score:0.0729

----- epoch 5 -----
[train] 19035/19035 10429(s) eta:0(s) loss:0.056420 loss200:0.054272 lr:1.78e-05 auc:0.9922 micro:0.9932 macro:0.9913
0.048365 [0.075117 0.009352 0.06377  0.056792 0.022804 0.0356  ]
[valid] 4730/4730 1775(s) eta:0(s) loss:0.093022 loss200:0.093413 lr:0.00e+00 auc:0.9785 micro:0.9813 macro:0.9757
0.079526 [0.131726 0.017186 0.108461 0.082765 0.032503 0.052314]
saved model to ./model/model001/fold4_ep5.pt
[best] ep:2 loss:0.0850 score:0.0729
