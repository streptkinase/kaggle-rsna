
----- 2019-10-22 21:39:11 -----
/mnt/disks/mount_point/rsna_root/kaggle-rsna-intracranial-hemorrhage/src/cnn/main.py train ./conf/model001.py --fold 3 --gpu 0
logpath: ./model/model001/train_fold3.log
mode: train
workdir: ./model/model001
fold: 3
batch size: 28
acc: 1
model: se_resnext50_32x4d
pretrained: imagenet
loss: BCEWithLogitsLoss
optim: Adam
dataset_policy: all
window_policy: 2
read dataset (531741 records)
applied dataset_policy all (531741 records)
use default(random) sampler
dataset_policy: all
window_policy: 2
read dataset (133673 records)
applied dataset_policy all (133673 records)
use default(random) sampler
train data: loaded 531741 records
valid data: loaded 133673 records
last_epoch: -1
apex True

----- epoch 0 -----
[train] 18990/18990 9955(s) eta:0(s) loss:0.101599 loss200:0.086274 lr:6.00e-05 auc:0.9689 micro:0.9742 macro:0.9637
0.087089 [0.140116 0.018703 0.1085   0.091727 0.045821 0.064642]
[valid] 4775/4775 1583(s) eta:0(s) loss:0.092383 loss200:0.088886 lr:0.00e+00 auc:0.9755 micro:0.9792 macro:0.9718
0.079253 [0.127032 0.0176   0.097673 0.089288 0.039311 0.056834]
saved model to ./model/model001/fold3_ep0.pt
[best] ep:0 loss:0.0924 score:0.0793

----- epoch 1 -----
[train] 18990/18990 10036(s) eta:0(s) loss:0.081280 loss200:0.080258 lr:4.00e-05 auc:0.9819 micro:0.9846 macro:0.9793
0.069667 [0.112324 0.014932 0.089178 0.075791 0.032753 0.050366]
[valid] 4775/4775 1611(s) eta:0(s) loss:0.086636 loss200:0.082611 lr:0.00e+00 auc:0.9792 micro:0.9824 macro:0.9761
0.074332 [0.120131 0.017545 0.093471 0.084508 0.032254 0.052285]
saved model to ./model/model001/fold3_ep1.pt
[best] ep:1 loss:0.0866 score:0.0743

----- epoch 2 -----
[train] 18990/18990 10047(s) eta:0(s) loss:0.072723 loss200:0.073698 lr:2.67e-05 auc:0.9863 micro:0.9882 macro:0.9843
0.062334 [0.100133 0.013055 0.080906 0.069075 0.028553 0.044482]
[valid] 4775/4775 1622(s) eta:0(s) loss:0.084028 loss200:0.081287 lr:0.00e+00 auc:0.9799 micro:0.9834 macro:0.9764
0.072019 [0.116412 0.017719 0.092152 0.080014 0.030592 0.050832]
saved model to ./model/model001/fold3_ep2.pt
[best] ep:2 loss:0.0840 score:0.0720

----- 2019-10-24 04:32:20 -----
/mnt/disks/mount_point/rsna_root/kaggle-rsna-intracranial-hemorrhage/src/cnn/main.py train ./conf/model001.py --fold 3 --gpu 0 --resume_from fold3_ep2.pt
logpath: ./model/model001/train_fold3.log

----- 2019-10-24 12:45:38 -----
/mnt/disks/mount_point/rsna_root/kaggle-rsna-intracranial-hemorrhage/src/cnn/main.py train ./conf/model001.py --fold 3 --gpu 0 --resume_from model/model001/fold3_ep2.pt
logpath: ./model/model001/train_fold3.log
mode: train
workdir: ./model/model001
fold: 3
batch size: 28
acc: 1
resume_from: model/model001/fold3_ep2.pt
model: se_resnext50_32x4d
pretrained: imagenet
loss: BCEWithLogitsLoss
optim: Adam
loading optim too
loaded model from model/model001/fold3_ep2.pt
dataset_policy: all
window_policy: 2
read dataset (531741 records)
applied dataset_policy all (531741 records)
use default(random) sampler
dataset_policy: all
window_policy: 2
read dataset (133673 records)
applied dataset_policy all (133673 records)
use default(random) sampler
train data: loaded 531741 records
valid data: loaded 133673 records
last_epoch: 2
apex True

----- 2019-10-25 19:09:46 -----
/mnt/disks/mount_point/rsna_root/kaggle-rsna-intracranial-hemorrhage/src/cnn/main.py train ./conf/model001.py --fold 3 --gpu 0 --resume_from model/model001/fold3_ep2.pt
logpath: ./model/model001/train_fold3.log
mode: train
workdir: ./model/model001
fold: 3
batch size: 28
acc: 1
resume_from: model/model001/fold3_ep2.pt
model: se_resnext50_32x4d
pretrained: imagenet
loss: BCEWithLogitsLoss
optim: Adam
loading optim too
loaded model from model/model001/fold3_ep2.pt
dataset_policy: all
window_policy: 2
read dataset (531741 records)
applied dataset_policy all (531741 records)
use default(random) sampler
dataset_policy: all
window_policy: 2
read dataset (133673 records)
applied dataset_policy all (133673 records)
use default(random) sampler
train data: loaded 531741 records
valid data: loaded 133673 records
last_epoch: 2
apex True

----- epoch 3 -----
[train] 18990/18990 10382(s) eta:0(s) loss:0.065290 loss200:0.069544 lr:1.78e-05 auc:0.9894 micro:0.9907 macro:0.9880
0.055967 [0.088863 0.011087 0.07339  0.063276 0.025927 0.04036 ]
[valid] 4775/4775 1763(s) eta:0(s) loss:0.085134 loss200:0.083138 lr:0.00e+00 auc:0.9803 micro:0.9839 macro:0.9767
0.073027 [0.119    0.018367 0.095139 0.079888 0.030562 0.049234]
saved model to ./model/model001/fold3_ep3.pt
[best] ep:2 loss:0.0840 score:0.0720

----- epoch 4 -----
[train] 18990/18990 10138(s) eta:0(s) loss:0.060963 loss200:0.062396 lr:1.78e-05 auc:0.9909 micro:0.9920 macro:0.9898
0.052260 [0.08239  0.009761 0.068732 0.060075 0.024533 0.037936]
[valid] 4775/4775 1796(s) eta:0(s) loss:0.087887 loss200:0.085304 lr:0.00e+00 auc:0.9781 micro:0.9823 macro:0.9738
0.075421 [0.122718 0.01954  0.098589 0.082074 0.03151  0.050802]
saved model to ./model/model001/fold3_ep4.pt
[best] ep:2 loss:0.0840 score:0.0720

----- epoch 5 -----
[train] 18990/18990 10297(s) eta:0(s) loss:0.056510 loss200:0.056294 lr:1.78e-05 auc:0.9923 micro:0.9932 macro:0.9914
0.048442 [0.075671 0.008493 0.063732 0.056941 0.02327  0.035316]
[valid] 4775/4775 1757(s) eta:0(s) loss:0.092305 loss200:0.091243 lr:0.00e+00 auc:0.9764 micro:0.9815 macro:0.9713
0.079141 [0.129602 0.020938 0.103377 0.087826 0.030526 0.052114]
saved model to ./model/model001/fold3_ep5.pt
[best] ep:2 loss:0.0840 score:0.0720
